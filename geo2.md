SURFACING PLAN

evaluate whether the newly added features—DA 2062 import/export, maintenance form autocomplete, document inbox, and pub log for NSN lookups—are being surfaced in the current UI. I’ll also suggest concrete UI/UX improvements to ensure these features are discoverable and integrated smoothly.

I'll get back to you shortly with my findings and suggestions.


# Reflection of New Features in HRX iOS UI and UX Recommendations

## Current UI Coverage of Recent Features

**DA Form 2062 Import (Scanning) & Export:** The codebase shows new SwiftUI views for importing and exporting DA-2062 forms, but these aren’t yet exposed in the app’s visible UI. For example, there is a `DA2062ScanView` (for scanning a physical DA-2062 hand receipt) that presents a “Import DA-2062” screen with a scan button. Similarly, a `DA2062ExportView` exists for exporting selected items to a DA-2062 PDF (with “Export DA 2062” as the title and action buttons). However, currently there is no obvious navigation path or button in the simulator to access these views. In the **Property** tab, the top-right **Plus (+)** button only opens the “Create Property” form, and no alternative “Import” option is offered. Likewise, on the **Property Detail** screen, there is a share/export icon reserved in the design, but it has no implemented action (“/\* share action \*/” placeholder), meaning exporting to DA-2062 is not hooked up yet. In short, although the scanning and export functionality is coded, the app UI doesn’t present any button or menu for the user to trigger these features in the current build.

**Maintenance Form Request (Auto-Populated):** The new **Send Maintenance Form** flow (auto-filling a DA-2404/5988-E with equipment info) is implemented in `SendMaintenanceFormView`, but it’s somewhat hidden. The expected usage is that a user would go to a property and initiate a maintenance request. In the current UI, the Property Detail screen’s bottom toolbar has a **“Service”** (wrench) button, but that opens a **Schedule Maintenance** dialog (for setting a date/notes) rather than the maintenance request form. There is **no visible “Send Maintenance Form” button** on the property screens. The only hint of this feature is in the **Dashboard** quick actions: the **“Maintain”** action on the home dashboard navigates to a **Maintenance** overview screen. On that **Maintenance** screen, a card labeled “Create Maintenance Request” directs the user to the Property Book (so they can choose an item), but after selecting an item, there’s still no direct prompt to open the form. In other words, the auto-populated maintenance form exists in code, but a user might not find it because the UI doesn’t explicitly offer a **“Send Maintenance Form”** action on an item – they’d have to know to go to the property’s **ellipsis menu or similar (which currently only offers “Schedule Maintenance”)**. This likely explains why you don’t see the maintenance form feature in the simulator UI.

**Documents Inbox:** The “documents inbox” for incoming forms is implemented and **is** accessible, though it’s tucked away in the new Maintenance section. In the **Maintenance** overview (reachable via Dashboard’s “Maintain” quick action), there’s a second quick-action card titled **“View Maintenance Forms”** that navigates to the `DocumentsView`. This Documents screen serves as the inbox, showing tabs for All, Unread, Maintenance, Archived documents, etc., with a “Documents” header. So the app does have a document inbox UI – if you navigate to **Maintenance > View Maintenance Forms**, you’ll see any received maintenance form PDFs listed. If you haven’t looked there, it’s easy to miss. Currently, the inbox isn’t on the main tab bar or home screen; it’s only signposted through the Maintenance workflow (with an unread count badge shown on that card when new forms arrive). So the functionality is present, but not obvious unless the user explores the Maintenance section.

**“Pub Log” NSN Database (Property Digital Twin):** The NSN lookup feature is integrated into the **Create Property** form. When adding a new property, there’s now an **“NSN/LIN Lookup”** section that lets users search a library of National Stock Numbers to auto-fill item details. In the UI, on the Create Property screen you’ll find a text field for NSN/LIN and a search button (magnifying glass). If the user taps the search **with the field empty**, it opens the `NSNSearchView` modal. From there, they can query by NSN, item name, or part number and get a list of results from the NSN database, then select one to populate the form. If the user already typed an NSN and hits the arrow button, it will attempt to look it up directly. This means the “pub log” NSN database functionality **is** reflected in the UI, but it might not be immediately apparent. The field is marked optional, and the user has to know to tap the search icon to invoke the NSN browser. There is a hint text (“Search or enter NSN/LIN to auto-populate item details”) under that section, but if you weren’t specifically looking for it, you might not realize the power of that feature.

*In summary*, most new features exist in the code but are either hidden behind non-intuitive navigation or not connected to UI controls at all. The **Documents Inbox** and **NSN auto-fill** are present (in Maintenance and Create Property respectively), but **DA-2062 scan/export** and **Maintenance form send** aren’t visibly accessible in the current UI, which is why you aren’t seeing them in the simulator.

## UX/UI Recommendations to Surface New Functionality

To better reflect these new features in the app’s UX, here are some SwiftUI-centric suggestions:

* **Surface the DA-2062 Import/Export Actions:** Consider adding explicit UI triggers for these features in the Property section. For instance, you could introduce an **“Import”** button or menu item on the **Property** list screen. Since the nav bar is already crowded (with Search, Add, Sort), one approach is to turn the **“+” (Add)** button into a context menu or segmented action:

  * Use a SwiftUI `ConfirmationDialog` or `Menu` on the **+** button that offers **“Add New Item”** and **“Import from DA-2062”**. This way, tapping + could default to create, but long-press or a dropdown gives the import option.
  * Alternatively, add a small **scan icon** (e.g. a document with viewfinder symbol) next to the +. Tapping that would push or present the `DA2062ScanView` for scanning a form. This icon could use the SF Symbol `doc.text.viewfinder` (which you already use in the scan view) for recognizability.
  * For **Export** (generating a DA-2062 PDF), you might add an **“Export”** option on the Property screen as well. One idea is to enable **multi-select mode** in the property list: for example, a toolbar button “Select Items” that lets users pick multiple assets and then tap **“Export to DA-2062”**. This mirrors the web workflow described (select items with checkboxes, then export) and would make the feature discoverable. SwiftUI doesn’t have built-in multi-select for `LazyVStack`, but you can manage selection state manually (e.g. an Edit mode with checkmarks) and then call `DA2062ExportView` with the selected items.
  * As a simpler interim solution, you could allow exporting **all** items or a single item. For instance, repurpose the **share** icon in the Property Detail view: tapping share on an item could generate a one-item DA-2062 PDF (or open `DA2062ExportView` pre-filtered to that item). At least this way, an export function is available per item (users often expect share/export on detail screens). In the future a more robust multi-item export UI can be added.

  *Why:* These changes ensure users can actually find and use the import/export features. Currently, without any UI element, the scanning and PDF generation capabilities are essentially hidden. Adding a menu or button in a familiar place (the Property list or detail screens) will make the new functionality apparent. For example, a context menu on the property list entries could also be used – a long-press on a property could show actions like “Send Maintenance Form” and “Export to DA-2062”. Context menus are nice for power users, though for critical features like these it’s better to also have visible buttons.

* **Make “Send Maintenance Form” Easily Accessible:** Integrate the maintenance request feature into the property UI flow more directly. Two approaches:

  * **In Property Detail:** Add a **“Send Maintenance Form”** action. You could include this in the existing **ellipsis (⋯) menu** on the Property Detail screen. Right now, the confirmationDialog lists “View History” and “Schedule Maintenance” if needed. You should add an option like **“Send Maintenance Request”** that, when tapped, presents the `SendMaintenanceFormView` for that item. This way, regardless of an item’s status, the user can initiate a maintenance form. The code for the form is already there; it’s just about providing an entry point. Since `SendMaintenanceFormView` expects a `Property` object, you can easily call it with the current property.
  * **In Property List:** Alternatively or additionally, implement a quick action from the list. For example, a swipe action on a property row (using `.swipeActions`) with a **“Maintenance”** button could trigger the form. In iOS, a trailing swipe could reveal a wrench icon; tapping it pushes the `SendMaintenanceFormView` for that item. This would be very intuitive – the user can directly request maintenance on an item without drilling into details.
  * If you want to emphasize this feature, the **Dashboard** itself could have a dedicated shortcut. Currently, the **Maintain** tile takes the user to the maintenance intro page. You might consider jumping straight into a maintenance form if the user has a specific item in mind. However, since the flow expects picking an item, integrating at the item level (as above) is more straightforward.

  Also, within the **Send Maintenance Form** UI, you might enhance UX by adding autocompletion or filtering for the **recipient list**. Right now, you pop up a `ConnectionPickerView` sheet for “Send To”. To make it smoother, you could allow searching your connections in that sheet (e.g., a search bar at top of the list) or pre-filter by online status, etc. This would align with an “autocomplete” concept – typing a name to find the recipient quickly. It’s a smaller tweak, but would polish the experience.

  *Why:* Presently, a user might not realize they need to go through the Maintenance screen to send a form, and even then the Maintenance screen instructs them to “Go to Property Book” and doesn’t automatically open a form. By placing a **“Send Maintenance Form”** button in the context of managing a specific property, we meet the user at the point of need. If something is broken, they’ll likely view that item and expect a way to report/request maintenance from there. This change will directly reflect the new maintenance autocomplete functionality in the UI flow.

* **Increase Visibility of the Documents Inbox:** Since the **Documents** inbox is only accessible via the Maintenance screen currently, consider giving it a more prominent entry point or notifications:

  * One idea is to add a **badge indicator** on the app’s profile or settings tab (since you label that tab “Profile” with a person icon). For example, if there are unread documents, show a red dot or badge number on the **Profile** icon. This requires your custom `MinimalTabBar` to observe the `DocumentService.unreadCount` and display a badge for the Profile item dynamically. It’s a bit of extra logic, but it will alert the user that something awaits in their inbox.
  * You could also add a shortcut to Documents in the **Profile/Settings** view itself. Perhaps under an “Inbox” section or as a row like “Documents Inbox (3 unread)” that navigates to `DocumentsView`. Since maintenance forms might involve user’s account and incoming files, the settings or profile screen is a reasonable place to list it.
  * Another approach: transform the **Maintenance** quick action flow. Instead of burying “View Maintenance Forms” one level deep, consider making **Maintenance Forms** a first-class tab or screen. For example, you might repurpose the **Transfers** tab or merge it (if transfers are less frequently used) and use that slot for “Forms” or “Inbox”. This might be a larger change, but if maintenance/document workflows are becoming core to the app, a dedicated tab could be justified.

  Short of adding a tab, simply renaming the Maintenance quick-action card to something like **“Maintenance & Inbox”** might draw attention that received forms live there. You already show the unread count on that card, which is great. Just ensure that if a user taps **Maintain** on Dashboard, they see clearly that **“View Maintenance Forms”** is the way to get to their inbox (perhaps highlight it or use an inbox icon). This is partially done with the tray icon and green highlight on the card.

  *Why:* Users might not instinctively check the Maintenance section for incoming documents. By providing a badge or direct link in a familiar place (profile or tab bar), you make it obvious that “there’s something new to see.” It improves the discoverability of the Document Inbox, ensuring the feature (and any important forms) won’t be overlooked.

* **Refine the NSN Search UX:** The NSN (“pub log”) integration is functional, but we can make it friendlier. The current design requires tapping the search button in the NSN field. A couple of tweaks:

  * **Auto-launch suggestions:** When the user focuses in the NSN text field or begins typing an item name, consider offering NSN suggestions proactively. For example, as they type the Item Name, if that field is blank or if no NSN has been entered, you might show a hint like “Looking for an official name/NSN? Try the NSN Lookup below.” Even automatically opening the NSN search sheet might be too forceful, but a prompt could help. Since you have a dedicated NSN search workflow, you could also allow partial name search through it. Perhaps a button “Search NSN by Item Name” next to the item name field could populate the NSN search query.
  * **Integrate search field and results:** Right now the NSN search is a separate sheet. You could integrate it inline by showing a list of NSN results right under the NSN text field as the user types (similar to an autocomplete dropdown). This would be a more advanced SwiftUI implementation (perhaps using a `List` that appears when results are loaded). If that’s complex, the current modal is fine, but maybe ensure the **placeholder text** on the NSN field is clear (it says “NSN or LIN (optional)”) and keep that helper text “Search or enter NSN…” visible – which it is. Maybe style that hint in a secondary color so it’s noticed.
  * One more minor UX point: after selecting an NSN from the database, the form auto-fills item name, etc. You might want to provide feedback like a brief highlight on the filled-in fields or a checkmark icon to show “Details loaded”. This just reassures the user that the import happened. Given this is a one-time action, it might be fine as is.

  *Why:* These adjustments ensure that the powerful NSN library feature actually gets used. If a user doesn’t know the acronym NSN or that the search icon will query a database, they might ignore it. By guiding them (through prompts or dynamic search results), you turn the “pub log” feature into a more natural part of creating a property. The goal is to help users create accurate digital twins of their equipment by finding the official data – the easier it is to access, the more they will benefit from it.

* **General UX Cohesion:** As you integrate these features, keep consistency with iOS design patterns:

  * Use **system icons** and labels that clearly describe the action (e.g. a scanner icon for import, a share or PDF icon for export, an inbox/tray for documents). The code already uses many SF Symbols appropriately.
  * Maintain a **clear navigation flow**. Features like scanning and exporting will likely be modals (since you present them in a `NavigationView` with Cancel buttons). Ensure that presenting and dismissing these modals is smooth. For instance, if you add a menu item “Import from DA-2062”, have it present the scanner full-screen and then on completion perhaps automatically show an import summary.
  * Leverage **SwiftUI’s state** to your advantage. You have a `documentService.shared` with an `unreadCount` – use `@Published` and `@EnvironmentObject` or similar to propagate changes so that badges update in real-time. Similarly, for multi-select exports, you might add an `EditMode` binding on the list and use SwiftUI’s built-in editing support for `List` (if you convert the LazyVStack to a List) to get selection for free.
  * Consider **user guidance**: For brand-new features, a one-time tutorial pop-up or a subtle coach-mark can help. For example, the first time you release the scanning feature, you might show a brief message on the Property screen like “New! Import an entire hand receipt via scan” pointing to the new button. This can be done with a simple state-driven banner.

By implementing the above changes, the UI in the simulator (and the app) will much better reflect the refactored capabilities. Users will see new buttons or menu options for the DA-2062 import/export, have a direct way to send maintenance forms, notice incoming form documents, and utilize the NSN database with ease. These adjustments should bridge the gap between your recent backend/code additions and a truly intuitive user experience, ensuring your hard work on new features translates into visible, usable functionality in the iOS app.

**Sources:**

* HRX iOS code showing new DA-2062 scan/import UI and lack of integration: `DA2062ScanView.swift`; `DA2062ExportView.swift`; Property list UI (`MyPropertiesView.swift`) with only Add button and no import/export option.
* Maintenance features in code: Maintenance quick actions and navigation; Missing “Send Form” in property menu (`PropertyDetailView.swift`); SendMaintenanceForm view implementation.
* Document Inbox in UI: MaintenanceView with “View Maintenance Forms” (documents inbox) link; DocumentsView UI loaded via that link.
* NSN Search integration: CreatePropertyView showing NSN lookup section and hint; NSNSearchView for searching NSN database.
